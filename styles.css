:root {
  --bg: #0b0f14;
  --fg: #e6e9ef;
  --muted: #94a3b8;
  --accent: #9b87f5;
  --danger: #ff6b6b;
  --glow: 0 0 40px rgba(155,135,245,.35);
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: radial-gradient(1200px 600px at 70% 30%, #121826 0%, #0b0f14 60%, #05070a 100%);
  color: var(--fg);
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Noto Sans", "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
}
.topbar {
  height: 56px; display:flex; align-items:center; justify-content:space-between;
  padding: 0 14px; border-bottom: 1px solid rgba(255,255,255,.06);
  backdrop-filter: blur(6px);
}
.brand { font-weight:700; letter-spacing:.06em; color:var(--accent); text-shadow: var(--glow); }
.controls button {
  margin-left:8px; padding:8px 10px; background:transparent; color:var(--fg); border:1px solid rgba(255,255,255,.15);
  border-radius: 10px; cursor:pointer;
}
.controls button:hover { background:rgba(255,255,255,.06); }

.stage { display:flex; gap:18px; padding:14px; height: calc(100vh - 56px - 42px); }
#stageCanvas { flex: 1 1 auto; width:100%; height:100%; border-radius:16px; background:rgba(255,255,255,.02); box-shadow: 0 10px 40px rgba(0,0,0,.35) inset; }

.sidebar { width: 420px; display:flex; flex-direction: column; gap: 16px; }
.panel { background: rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); padding:14px; border-radius:14px; box-shadow: 0 6px 28px rgba(0,0,0,.25); }
.panel label { display:block; font-size:12px; color: var(--muted); margin-bottom:6px; }
.panel input { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(0,0,0,.25); color:var(--fg); }
.buttons { display:flex; gap:8px; margin-top:10px; }
button.primary { background: linear-gradient(180deg, #b29dfb, #8f79f9); color:#101217; border:none; padding:10px 14px; border-radius:12px; box-shadow: 0 10px 30px rgba(155,135,245,.35); cursor:pointer; }
button.primary:hover{ filter: brightness(1.05); }
button.danger { background: linear-gradient(180deg, #ff8585, #ff6b6b); color:#101217; border:none; padding:10px 14px; border-radius:12px; box-shadow: 0 10px 30px rgba(255,107,107,.35); cursor:pointer; }
button:disabled { opacity:.5; cursor:not-allowed; }
.timer { margin-top:8px; font-variant-numeric: tabular-nums; color: var(--muted); }

.story { flex:1 1 auto; overflow:auto; background: rgba(255,255,255,.02); border:1px solid rgba(255,255,255,.06); border-radius:14px; padding:14px; line-height:1.8; }
.story .line { opacity:.95; }
.story .shard { display:inline-block; }

.footer { height: 42px; display:flex; align-items:center; padding:0 14px; color:var(--muted); border-top: 1px solid rgba(255,255,255,.06); }

/* 文字崩落アニメーション */
@keyframes fall { to { transform: translate(var(--dx, 0px), var(--dy, 60px)) rotate(var(--rot, 0deg)); opacity: 0; filter: blur(2px); } }

/* グリッチ用（キャンバスに適用する強調テキルクラス） */
.glitch { filter: contrast(1.2) saturate(1.15) brightness(1.05); }

:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
